import { LearnerAssessmentsEntry, LearnerSummaryEntry, ProfileEntry } from '../../profile/db/schema';
import { ArrayUtil } from '../../util/array-util';
var SummarizerQueries = /** @class */ (function () {
    function SummarizerQueries() {
    }
    SummarizerQueries.getChildProgressQuery = function (uids) {
        return "SELECT " + LearnerAssessmentsEntry.COLUMN_NAME_UID + ", " + LearnerAssessmentsEntry.COLUMN_NAME_CONTENT_ID + ",\n                COUNT (" + LearnerAssessmentsEntry.COLUMN_NAME_QID + ") AS no_of_questions,\n                SUM (" + LearnerAssessmentsEntry.COLUMN_NAME_CORRECT + ") AS correct_answers,\n                SUM (" + LearnerAssessmentsEntry.COLUMN_NAME_TIME_SPENT + ") AS total_time_spent, h_data ,\n                SUM (" + LearnerAssessmentsEntry.COLUMN_NAME_MAX_SCORE + ") AS total_max_score,\n                SUM (" + LearnerAssessmentsEntry.COLUMN_NAME_SCORE + ") AS total_score\n                FROM  " + LearnerAssessmentsEntry.TABLE_NAME + "\n                WHERE " + LearnerAssessmentsEntry.COLUMN_NAME_UID + " IN (" + ArrayUtil.joinPreservingQuotes(uids) + ")\n                GROUP BY " + LearnerAssessmentsEntry.COLUMN_NAME_CONTENT_ID + " ";
    };
    SummarizerQueries.getDetailReportsQuery = function (uids, contentId) {
        return "SELECT *, lcs." + LearnerSummaryEntry.COLUMN_NAME_TOTAL_TS + "\n                FROM  " + LearnerAssessmentsEntry.TABLE_NAME + " la\n                LEFT JOIN " + LearnerSummaryEntry.TABLE_NAME + " lcs\n                ON (la." + LearnerSummaryEntry.COLUMN_NAME_UID + " = lcs." + LearnerAssessmentsEntry.COLUMN_NAME_UID + ")\n                AND la." + LearnerSummaryEntry.COLUMN_NAME_CONTENT_ID + " = lcs." + LearnerAssessmentsEntry.COLUMN_NAME_CONTENT_ID + "\n                WHERE la." + LearnerAssessmentsEntry.COLUMN_NAME_UID + " IN(" + ArrayUtil.joinPreservingQuotes(uids) + ")\n                AND la." + LearnerAssessmentsEntry.COLUMN_NAME_CONTENT_ID + "='" + contentId + "'";
    };
    SummarizerQueries.getReportsByUserQuery = function (uids, contentId) {
        return "SELECT lcs." + LearnerSummaryEntry.COLUMN_NAME_TOTAL_TS + ",\n                SUM (" + LearnerAssessmentsEntry.COLUMN_NAME_SCORE + ") AS score,\n                la." + LearnerAssessmentsEntry.COLUMN_NAME_HIERARCHY_DATA + ",la." + LearnerAssessmentsEntry.COLUMN_NAME_CONTENT_ID + ",\n                la." + LearnerAssessmentsEntry.COLUMN_NAME_UID + ",p." + ProfileEntry.COLUMN_NAME_HANDLE + ",\n                la." + LearnerAssessmentsEntry.COLUMN_NAME_TIME_SPENT + "\n                FROM " + LearnerAssessmentsEntry.TABLE_NAME + " la\n                LEFT JOIN " + LearnerSummaryEntry.TABLE_NAME + " lcs\n                ON (la." + LearnerSummaryEntry.COLUMN_NAME_UID + " = lcs." + LearnerAssessmentsEntry.COLUMN_NAME_UID + ")\n                LEFT JOIN " + ProfileEntry.TABLE_NAME + " p\n                ON (la." + LearnerAssessmentsEntry.COLUMN_NAME_UID + " = p." + ProfileEntry.COLUMN_NAME_UID + ")\n                WHERE la." + LearnerAssessmentsEntry.COLUMN_NAME_UID + " IN(" + ArrayUtil.joinPreservingQuotes(uids) + ")\n                AND la." + LearnerAssessmentsEntry.COLUMN_NAME_CONTENT_ID + "='" + contentId + "'\n                GROUP BY la." + LearnerAssessmentsEntry.COLUMN_NAME_UID;
    };
    SummarizerQueries.getQuetsionDetailsQuery = function (uids, contentId, qid) {
        return "SELECT " + LearnerAssessmentsEntry.COLUMN_NAME_UID + ", " + LearnerAssessmentsEntry.COLUMN_NAME_TIME_SPENT + " as time,\n                " + LearnerAssessmentsEntry.COLUMN_NAME_SCORE + " as result,\n                " + LearnerAssessmentsEntry.COLUMN_NAME_MAX_SCORE + " as max_score\n                FROM " + LearnerAssessmentsEntry.TABLE_NAME + "\n                WHERE " + LearnerAssessmentsEntry.COLUMN_NAME_UID + " IN(" + ArrayUtil.joinPreservingQuotes(uids) + ")\n                AND " + LearnerAssessmentsEntry.COLUMN_NAME_CONTENT_ID + "='" + contentId + "'\n                AND " + LearnerAssessmentsEntry.COLUMN_NAME_QID + "='" + qid + "'";
    };
    SummarizerQueries.getReportAccuracyQuery = function (uids, contentId) {
        return "SELECT " + LearnerAssessmentsEntry.COLUMN_NAME_QID + ", COUNT (*) as users_count\n                FROM  " + LearnerAssessmentsEntry.TABLE_NAME + "\n                WHERE " + LearnerAssessmentsEntry.COLUMN_NAME_UID + " IN(" + ArrayUtil.joinPreservingQuotes(uids) + ")\n                AND " + LearnerAssessmentsEntry.COLUMN_NAME_CONTENT_ID + "='" + contentId + "'\n                AND " + LearnerAssessmentsEntry.COLUMN_NAME_SCORE + " > 0\n                GROUP BY " + LearnerAssessmentsEntry.COLUMN_NAME_QID;
    };
    SummarizerQueries.getQuestionReportsQuery = function (uids, contentId) {
        return "SELECT *, SUM(" + LearnerAssessmentsEntry.COLUMN_NAME_SCORE + ") as marks,\n                COUNT (" + LearnerAssessmentsEntry.COLUMN_NAME_Q_INDEX + ") as occurence_count,\n                SUM (" + LearnerAssessmentsEntry.COLUMN_NAME_MAX_SCORE + ") as  sum_max_score\n                FROM " + LearnerAssessmentsEntry.TABLE_NAME + "\n                WHERE " + LearnerAssessmentsEntry.COLUMN_NAME_UID + " IN(" + ArrayUtil.joinPreservingQuotes(uids) + ")\n                AND " + LearnerAssessmentsEntry.COLUMN_NAME_CONTENT_ID + "='" + contentId + "'\n                GROUP BY " + LearnerAssessmentsEntry.COLUMN_NAME_QID;
    };
    SummarizerQueries.getFilterForLearnerAssessmentDetails = function (qid, uid, contentId, hierarchyData) {
        var qidFilter = LearnerAssessmentsEntry.COLUMN_NAME_QID + " = '" + qid + "'";
        var uidFilter = LearnerAssessmentsEntry.COLUMN_NAME_UID + " = '" + uid + "'";
        var contentIdFilter = LearnerAssessmentsEntry.COLUMN_NAME_CONTENT_ID + " = '" + contentId + "'";
        var hDataFilter = LearnerAssessmentsEntry.COLUMN_NAME_HIERARCHY_DATA + " = '" + (hierarchyData ? hierarchyData : '') + "'";
        var filter = "WHERE " + uidFilter + " AND " + contentIdFilter + " AND " + hDataFilter + " " + (qid ? " AND " + qidFilter : '');
        return filter;
    };
    SummarizerQueries.getLearnerAssessmentsQuery = function (filter) {
        var query = "SELECT * from " + LearnerAssessmentsEntry.TABLE_NAME + " " + filter + "\n                       ORDER BY " + LearnerAssessmentsEntry.COLUMN_NAME_Q_INDEX;
        return query;
    };
    SummarizerQueries.getUpdateSelection = function () {
        var query = LearnerAssessmentsEntry.COLUMN_NAME_UID + " = ? AND " +
            (LearnerAssessmentsEntry.COLUMN_NAME_CONTENT_ID + " = ? AND ") +
            (LearnerAssessmentsEntry.COLUMN_NAME_HIERARCHY_DATA + " = ? AND ") +
            (LearnerAssessmentsEntry.COLUMN_NAME_QID + " = ? ");
        return query;
    };
    SummarizerQueries.getLearnerSummaryReadSelection = function (hData) {
        var query = LearnerAssessmentsEntry.COLUMN_NAME_UID + " = ? AND " +
            (LearnerAssessmentsEntry.COLUMN_NAME_CONTENT_ID + " = ? AND ") +
            (LearnerAssessmentsEntry.COLUMN_NAME_HIERARCHY_DATA + " = ? ");
        return query;
    };
    return SummarizerQueries;
}());
export { SummarizerQueries };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3VtbWFyaXplci1xdWVyaWVzLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL3N1bW1hcml6ZXIvaGFuZGxlci9zdW1tYXJpemVyLXF1ZXJpZXMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFDLHVCQUF1QixFQUFFLG1CQUFtQixFQUFFLFlBQVksRUFBQyxNQUFNLHlCQUF5QixDQUFDO0FBQ25HLE9BQU8sRUFBQyxTQUFTLEVBQUMsTUFBTSx1QkFBdUIsQ0FBQztBQUVoRDtJQUFBO0lBa0dBLENBQUM7SUFqR2lCLHVDQUFxQixHQUFuQyxVQUFvQyxJQUFjO1FBQzlDLE9BQU8sWUFBVSx1QkFBdUIsQ0FBQyxlQUFlLFVBQUssdUJBQXVCLENBQUMsc0JBQXNCLGtDQUMxRix1QkFBdUIsQ0FBQyxlQUFlLG9EQUN6Qyx1QkFBdUIsQ0FBQyxtQkFBbUIsb0RBQzNDLHVCQUF1QixDQUFDLHNCQUFzQiw4REFDOUMsdUJBQXVCLENBQUMscUJBQXFCLG9EQUM3Qyx1QkFBdUIsQ0FBQyxpQkFBaUIsZ0RBQ3hDLHVCQUF1QixDQUFDLFVBQVUsZ0NBQ2xDLHVCQUF1QixDQUFDLGVBQWUsYUFBUSxTQUFTLENBQUMsb0JBQW9CLENBQUMsSUFBSSxDQUFDLG9DQUNoRix1QkFBdUIsQ0FBQyxzQkFBc0IsTUFBRyxDQUFDO0lBQ3pFLENBQUM7SUFFYSx1Q0FBcUIsR0FBbkMsVUFBb0MsSUFBYyxFQUFFLFNBQWlCO1FBQ2pFLE9BQU8sbUJBQWlCLG1CQUFtQixDQUFDLG9CQUFvQixnQ0FDaEQsdUJBQXVCLENBQUMsVUFBVSx1Q0FDOUIsbUJBQW1CLENBQUMsVUFBVSxxQ0FDakMsbUJBQW1CLENBQUMsZUFBZSxlQUFVLHVCQUF1QixDQUFDLGVBQWUsa0NBQ3BGLG1CQUFtQixDQUFDLHNCQUFzQixlQUFVLHVCQUF1QixDQUFDLHNCQUFzQixtQ0FDaEcsdUJBQXVCLENBQUMsZUFBZSxZQUFPLFNBQVMsQ0FBQyxvQkFBb0IsQ0FBQyxJQUFJLENBQUMsa0NBQ3BGLHVCQUF1QixDQUFDLHNCQUFzQixVQUFLLFNBQVMsTUFBRyxDQUFDO0lBQ3JGLENBQUM7SUFFYSx1Q0FBcUIsR0FBbkMsVUFBb0MsSUFBYyxFQUFFLFNBQWlCO1FBQ2pFLE9BQU8sZ0JBQWMsbUJBQW1CLENBQUMsb0JBQW9CLGdDQUM5Qyx1QkFBdUIsQ0FBQyxpQkFBaUIsd0NBQzNDLHVCQUF1QixDQUFDLDBCQUEwQixZQUFPLHVCQUF1QixDQUFDLHNCQUFzQiw4QkFDdkcsdUJBQXVCLENBQUMsZUFBZSxXQUFNLFlBQVksQ0FBQyxrQkFBa0IsOEJBQzVFLHVCQUF1QixDQUFDLHNCQUFzQiwrQkFDNUMsdUJBQXVCLENBQUMsVUFBVSx1Q0FDN0IsbUJBQW1CLENBQUMsVUFBVSxxQ0FDakMsbUJBQW1CLENBQUMsZUFBZSxlQUFVLHVCQUF1QixDQUFDLGVBQWUscUNBQ2pGLFlBQVksQ0FBQyxVQUFVLG1DQUMxQix1QkFBdUIsQ0FBQyxlQUFlLGFBQVEsWUFBWSxDQUFDLGVBQWUsb0NBQ3pFLHVCQUF1QixDQUFDLGVBQWUsWUFBTyxTQUFTLENBQUMsb0JBQW9CLENBQUMsSUFBSSxDQUFDLGtDQUNwRix1QkFBdUIsQ0FBQyxzQkFBc0IsVUFBSyxTQUFTLHVDQUN2RCx1QkFBdUIsQ0FBQyxlQUFpQixDQUFDO0lBQ3BFLENBQUM7SUFFYSx5Q0FBdUIsR0FBckMsVUFBc0MsSUFBYyxFQUFFLFNBQWlCLEVBQUUsR0FBVztRQUNoRixPQUFPLFlBQVUsdUJBQXVCLENBQUMsZUFBZSxVQUFLLHVCQUF1QixDQUFDLHNCQUFzQixtQ0FDakcsdUJBQXVCLENBQUMsaUJBQWlCLHFDQUN6Qyx1QkFBdUIsQ0FBQyxxQkFBcUIsNENBQ3hDLHVCQUF1QixDQUFDLFVBQVUsZ0NBQ2pDLHVCQUF1QixDQUFDLGVBQWUsWUFBTyxTQUFTLENBQUMsb0JBQW9CLENBQUMsSUFBSSxDQUFDLCtCQUNwRix1QkFBdUIsQ0FBQyxzQkFBc0IsVUFBSyxTQUFTLCtCQUM1RCx1QkFBdUIsQ0FBQyxlQUFlLFVBQUssR0FBRyxNQUFHLENBQUM7SUFDckUsQ0FBQztJQUVhLHdDQUFzQixHQUFwQyxVQUFxQyxJQUFjLEVBQUUsU0FBaUI7UUFDbEUsT0FBTyxZQUFVLHVCQUF1QixDQUFDLGVBQWUsMERBQ3hDLHVCQUF1QixDQUFDLFVBQVUsZ0NBQ2xDLHVCQUF1QixDQUFDLGVBQWUsWUFBTyxTQUFTLENBQUMsb0JBQW9CLENBQUMsSUFBSSxDQUFDLCtCQUNwRix1QkFBdUIsQ0FBQyxzQkFBc0IsVUFBSyxTQUFTLCtCQUM1RCx1QkFBdUIsQ0FBQyxpQkFBaUIsdUNBQ3BDLHVCQUF1QixDQUFDLGVBQWlCLENBQUM7SUFDakUsQ0FBQztJQUVhLHlDQUF1QixHQUFyQyxVQUFzQyxJQUFjLEVBQUUsU0FBaUI7UUFDbkUsT0FBTyxtQkFBaUIsdUJBQXVCLENBQUMsaUJBQWlCLDRDQUNoRCx1QkFBdUIsQ0FBQyxtQkFBbUIsb0RBQzdDLHVCQUF1QixDQUFDLHFCQUFxQixrREFDN0MsdUJBQXVCLENBQUMsVUFBVSxnQ0FDakMsdUJBQXVCLENBQUMsZUFBZSxZQUFPLFNBQVMsQ0FBQyxvQkFBb0IsQ0FBQyxJQUFJLENBQUMsK0JBQ3BGLHVCQUF1QixDQUFDLHNCQUFzQixVQUFLLFNBQVMsb0NBQ3ZELHVCQUF1QixDQUFDLGVBQWlCLENBQUM7SUFDakUsQ0FBQztJQUVhLHNEQUFvQyxHQUFsRCxVQUFtRCxHQUFXLEVBQUUsR0FBVyxFQUFFLFNBQWlCLEVBQUUsYUFBcUI7UUFDakgsSUFBTSxTQUFTLEdBQU0sdUJBQXVCLENBQUMsZUFBZSxZQUFPLEdBQUcsTUFBRyxDQUFDO1FBQzFFLElBQU0sU0FBUyxHQUFNLHVCQUF1QixDQUFDLGVBQWUsWUFBTyxHQUFHLE1BQUcsQ0FBQztRQUMxRSxJQUFNLGVBQWUsR0FBTSx1QkFBdUIsQ0FBQyxzQkFBc0IsWUFBTyxTQUFTLE1BQUcsQ0FBQztRQUM3RixJQUFNLFdBQVcsR0FBTSx1QkFBdUIsQ0FBQywwQkFBMEIsYUFBTyxhQUFhLENBQUMsQ0FBQyxDQUFDLGFBQWEsQ0FBQyxDQUFDLENBQUMsRUFBRSxPQUFHLENBQUM7UUFDdEgsSUFBTSxNQUFNLEdBQUcsV0FBUyxTQUFTLGFBQVEsZUFBZSxhQUFRLFdBQVcsVUFBSSxHQUFHLENBQUMsQ0FBQyxDQUFDLFVBQVEsU0FBVyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUUsQ0FBQztRQUNoSCxPQUFPLE1BQU0sQ0FBQztJQUNsQixDQUFDO0lBRWEsNENBQTBCLEdBQXhDLFVBQXlDLE1BQWM7UUFDbkQsSUFBTSxLQUFLLEdBQUcsbUJBQWlCLHVCQUF1QixDQUFDLFVBQVUsU0FBSSxNQUFNLDBDQUNqRCx1QkFBdUIsQ0FBQyxtQkFBcUIsQ0FBQztRQUN4RSxPQUFPLEtBQUssQ0FBQztJQUNqQixDQUFDO0lBRWEsb0NBQWtCLEdBQWhDO1FBQ0ksSUFBTSxLQUFLLEdBQU0sdUJBQXVCLENBQUMsZUFBZSxjQUFXO2FBQ2pELHVCQUF1QixDQUFDLHNCQUFzQixjQUFXLENBQUE7YUFDekQsdUJBQXVCLENBQUMsMEJBQTBCLGNBQVcsQ0FBQTthQUM3RCx1QkFBdUIsQ0FBQyxlQUFlLFVBQU8sQ0FBQSxDQUFDO1FBQ2pFLE9BQU8sS0FBSyxDQUFDO0lBQ2pCLENBQUM7SUFFYSxnREFBOEIsR0FBNUMsVUFBNkMsS0FBYTtRQUN0RCxJQUFNLEtBQUssR0FBTSx1QkFBdUIsQ0FBQyxlQUFlLGNBQVc7YUFDakQsdUJBQXVCLENBQUMsc0JBQXNCLGNBQVcsQ0FBQTthQUN6RCx1QkFBdUIsQ0FBQywwQkFBMEIsVUFBTyxDQUFBLENBQUM7UUFDNUUsT0FBTyxLQUFLLENBQUM7SUFDakIsQ0FBQztJQUVMLHdCQUFDO0FBQUQsQ0FBQyxBQWxHRCxJQWtHQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7TGVhcm5lckFzc2Vzc21lbnRzRW50cnksIExlYXJuZXJTdW1tYXJ5RW50cnksIFByb2ZpbGVFbnRyeX0gZnJvbSAnLi4vLi4vcHJvZmlsZS9kYi9zY2hlbWEnO1xuaW1wb3J0IHtBcnJheVV0aWx9IGZyb20gJy4uLy4uL3V0aWwvYXJyYXktdXRpbCc7XG5cbmV4cG9ydCBjbGFzcyBTdW1tYXJpemVyUXVlcmllcyB7XG4gICAgcHVibGljIHN0YXRpYyBnZXRDaGlsZFByb2dyZXNzUXVlcnkodWlkczogc3RyaW5nW10pOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gYFNFTEVDVCAke0xlYXJuZXJBc3Nlc3NtZW50c0VudHJ5LkNPTFVNTl9OQU1FX1VJRH0sICR7TGVhcm5lckFzc2Vzc21lbnRzRW50cnkuQ09MVU1OX05BTUVfQ09OVEVOVF9JRH0sXG4gICAgICAgICAgICAgICAgQ09VTlQgKCR7TGVhcm5lckFzc2Vzc21lbnRzRW50cnkuQ09MVU1OX05BTUVfUUlEfSkgQVMgbm9fb2ZfcXVlc3Rpb25zLFxuICAgICAgICAgICAgICAgIFNVTSAoJHtMZWFybmVyQXNzZXNzbWVudHNFbnRyeS5DT0xVTU5fTkFNRV9DT1JSRUNUfSkgQVMgY29ycmVjdF9hbnN3ZXJzLFxuICAgICAgICAgICAgICAgIFNVTSAoJHtMZWFybmVyQXNzZXNzbWVudHNFbnRyeS5DT0xVTU5fTkFNRV9USU1FX1NQRU5UfSkgQVMgdG90YWxfdGltZV9zcGVudCwgaF9kYXRhICxcbiAgICAgICAgICAgICAgICBTVU0gKCR7TGVhcm5lckFzc2Vzc21lbnRzRW50cnkuQ09MVU1OX05BTUVfTUFYX1NDT1JFfSkgQVMgdG90YWxfbWF4X3Njb3JlLFxuICAgICAgICAgICAgICAgIFNVTSAoJHtMZWFybmVyQXNzZXNzbWVudHNFbnRyeS5DT0xVTU5fTkFNRV9TQ09SRX0pIEFTIHRvdGFsX3Njb3JlXG4gICAgICAgICAgICAgICAgRlJPTSAgJHtMZWFybmVyQXNzZXNzbWVudHNFbnRyeS5UQUJMRV9OQU1FfVxuICAgICAgICAgICAgICAgIFdIRVJFICR7TGVhcm5lckFzc2Vzc21lbnRzRW50cnkuQ09MVU1OX05BTUVfVUlEfSBJTiAoJHtBcnJheVV0aWwuam9pblByZXNlcnZpbmdRdW90ZXModWlkcyl9KVxuICAgICAgICAgICAgICAgIEdST1VQIEJZICR7TGVhcm5lckFzc2Vzc21lbnRzRW50cnkuQ09MVU1OX05BTUVfQ09OVEVOVF9JRH0gYDtcbiAgICB9XG5cbiAgICBwdWJsaWMgc3RhdGljIGdldERldGFpbFJlcG9ydHNRdWVyeSh1aWRzOiBzdHJpbmdbXSwgY29udGVudElkOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gYFNFTEVDVCAqLCBsY3MuJHtMZWFybmVyU3VtbWFyeUVudHJ5LkNPTFVNTl9OQU1FX1RPVEFMX1RTfVxuICAgICAgICAgICAgICAgIEZST00gICR7TGVhcm5lckFzc2Vzc21lbnRzRW50cnkuVEFCTEVfTkFNRX0gbGFcbiAgICAgICAgICAgICAgICBMRUZUIEpPSU4gJHtMZWFybmVyU3VtbWFyeUVudHJ5LlRBQkxFX05BTUV9IGxjc1xuICAgICAgICAgICAgICAgIE9OIChsYS4ke0xlYXJuZXJTdW1tYXJ5RW50cnkuQ09MVU1OX05BTUVfVUlEfSA9IGxjcy4ke0xlYXJuZXJBc3Nlc3NtZW50c0VudHJ5LkNPTFVNTl9OQU1FX1VJRH0pXG4gICAgICAgICAgICAgICAgQU5EIGxhLiR7TGVhcm5lclN1bW1hcnlFbnRyeS5DT0xVTU5fTkFNRV9DT05URU5UX0lEfSA9IGxjcy4ke0xlYXJuZXJBc3Nlc3NtZW50c0VudHJ5LkNPTFVNTl9OQU1FX0NPTlRFTlRfSUR9XG4gICAgICAgICAgICAgICAgV0hFUkUgbGEuJHtMZWFybmVyQXNzZXNzbWVudHNFbnRyeS5DT0xVTU5fTkFNRV9VSUR9IElOKCR7QXJyYXlVdGlsLmpvaW5QcmVzZXJ2aW5nUXVvdGVzKHVpZHMpfSlcbiAgICAgICAgICAgICAgICBBTkQgbGEuJHtMZWFybmVyQXNzZXNzbWVudHNFbnRyeS5DT0xVTU5fTkFNRV9DT05URU5UX0lEfT0nJHtjb250ZW50SWR9J2A7XG4gICAgfVxuXG4gICAgcHVibGljIHN0YXRpYyBnZXRSZXBvcnRzQnlVc2VyUXVlcnkodWlkczogc3RyaW5nW10sIGNvbnRlbnRJZDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIGBTRUxFQ1QgbGNzLiR7TGVhcm5lclN1bW1hcnlFbnRyeS5DT0xVTU5fTkFNRV9UT1RBTF9UU30sXG4gICAgICAgICAgICAgICAgU1VNICgke0xlYXJuZXJBc3Nlc3NtZW50c0VudHJ5LkNPTFVNTl9OQU1FX1NDT1JFfSkgQVMgc2NvcmUsXG4gICAgICAgICAgICAgICAgbGEuJHtMZWFybmVyQXNzZXNzbWVudHNFbnRyeS5DT0xVTU5fTkFNRV9ISUVSQVJDSFlfREFUQX0sbGEuJHtMZWFybmVyQXNzZXNzbWVudHNFbnRyeS5DT0xVTU5fTkFNRV9DT05URU5UX0lEfSxcbiAgICAgICAgICAgICAgICBsYS4ke0xlYXJuZXJBc3Nlc3NtZW50c0VudHJ5LkNPTFVNTl9OQU1FX1VJRH0scC4ke1Byb2ZpbGVFbnRyeS5DT0xVTU5fTkFNRV9IQU5ETEV9LFxuICAgICAgICAgICAgICAgIGxhLiR7TGVhcm5lckFzc2Vzc21lbnRzRW50cnkuQ09MVU1OX05BTUVfVElNRV9TUEVOVH1cbiAgICAgICAgICAgICAgICBGUk9NICR7TGVhcm5lckFzc2Vzc21lbnRzRW50cnkuVEFCTEVfTkFNRX0gbGFcbiAgICAgICAgICAgICAgICBMRUZUIEpPSU4gJHtMZWFybmVyU3VtbWFyeUVudHJ5LlRBQkxFX05BTUV9IGxjc1xuICAgICAgICAgICAgICAgIE9OIChsYS4ke0xlYXJuZXJTdW1tYXJ5RW50cnkuQ09MVU1OX05BTUVfVUlEfSA9IGxjcy4ke0xlYXJuZXJBc3Nlc3NtZW50c0VudHJ5LkNPTFVNTl9OQU1FX1VJRH0pXG4gICAgICAgICAgICAgICAgTEVGVCBKT0lOICR7UHJvZmlsZUVudHJ5LlRBQkxFX05BTUV9IHBcbiAgICAgICAgICAgICAgICBPTiAobGEuJHtMZWFybmVyQXNzZXNzbWVudHNFbnRyeS5DT0xVTU5fTkFNRV9VSUR9ID0gcC4ke1Byb2ZpbGVFbnRyeS5DT0xVTU5fTkFNRV9VSUR9KVxuICAgICAgICAgICAgICAgIFdIRVJFIGxhLiR7TGVhcm5lckFzc2Vzc21lbnRzRW50cnkuQ09MVU1OX05BTUVfVUlEfSBJTigke0FycmF5VXRpbC5qb2luUHJlc2VydmluZ1F1b3Rlcyh1aWRzKX0pXG4gICAgICAgICAgICAgICAgQU5EIGxhLiR7TGVhcm5lckFzc2Vzc21lbnRzRW50cnkuQ09MVU1OX05BTUVfQ09OVEVOVF9JRH09JyR7Y29udGVudElkfSdcbiAgICAgICAgICAgICAgICBHUk9VUCBCWSBsYS4ke0xlYXJuZXJBc3Nlc3NtZW50c0VudHJ5LkNPTFVNTl9OQU1FX1VJRH1gO1xuICAgIH1cblxuICAgIHB1YmxpYyBzdGF0aWMgZ2V0UXVldHNpb25EZXRhaWxzUXVlcnkodWlkczogc3RyaW5nW10sIGNvbnRlbnRJZDogc3RyaW5nLCBxaWQ6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiBgU0VMRUNUICR7TGVhcm5lckFzc2Vzc21lbnRzRW50cnkuQ09MVU1OX05BTUVfVUlEfSwgJHtMZWFybmVyQXNzZXNzbWVudHNFbnRyeS5DT0xVTU5fTkFNRV9USU1FX1NQRU5UfSBhcyB0aW1lLFxuICAgICAgICAgICAgICAgICR7TGVhcm5lckFzc2Vzc21lbnRzRW50cnkuQ09MVU1OX05BTUVfU0NPUkV9IGFzIHJlc3VsdCxcbiAgICAgICAgICAgICAgICAke0xlYXJuZXJBc3Nlc3NtZW50c0VudHJ5LkNPTFVNTl9OQU1FX01BWF9TQ09SRX0gYXMgbWF4X3Njb3JlXG4gICAgICAgICAgICAgICAgRlJPTSAke0xlYXJuZXJBc3Nlc3NtZW50c0VudHJ5LlRBQkxFX05BTUV9XG4gICAgICAgICAgICAgICAgV0hFUkUgJHtMZWFybmVyQXNzZXNzbWVudHNFbnRyeS5DT0xVTU5fTkFNRV9VSUR9IElOKCR7QXJyYXlVdGlsLmpvaW5QcmVzZXJ2aW5nUXVvdGVzKHVpZHMpfSlcbiAgICAgICAgICAgICAgICBBTkQgJHtMZWFybmVyQXNzZXNzbWVudHNFbnRyeS5DT0xVTU5fTkFNRV9DT05URU5UX0lEfT0nJHtjb250ZW50SWR9J1xuICAgICAgICAgICAgICAgIEFORCAke0xlYXJuZXJBc3Nlc3NtZW50c0VudHJ5LkNPTFVNTl9OQU1FX1FJRH09JyR7cWlkfSdgO1xuICAgIH1cblxuICAgIHB1YmxpYyBzdGF0aWMgZ2V0UmVwb3J0QWNjdXJhY3lRdWVyeSh1aWRzOiBzdHJpbmdbXSwgY29udGVudElkOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gYFNFTEVDVCAke0xlYXJuZXJBc3Nlc3NtZW50c0VudHJ5LkNPTFVNTl9OQU1FX1FJRH0sIENPVU5UICgqKSBhcyB1c2Vyc19jb3VudFxuICAgICAgICAgICAgICAgIEZST00gICR7TGVhcm5lckFzc2Vzc21lbnRzRW50cnkuVEFCTEVfTkFNRX1cbiAgICAgICAgICAgICAgICBXSEVSRSAke0xlYXJuZXJBc3Nlc3NtZW50c0VudHJ5LkNPTFVNTl9OQU1FX1VJRH0gSU4oJHtBcnJheVV0aWwuam9pblByZXNlcnZpbmdRdW90ZXModWlkcyl9KVxuICAgICAgICAgICAgICAgIEFORCAke0xlYXJuZXJBc3Nlc3NtZW50c0VudHJ5LkNPTFVNTl9OQU1FX0NPTlRFTlRfSUR9PScke2NvbnRlbnRJZH0nXG4gICAgICAgICAgICAgICAgQU5EICR7TGVhcm5lckFzc2Vzc21lbnRzRW50cnkuQ09MVU1OX05BTUVfU0NPUkV9ID4gMFxuICAgICAgICAgICAgICAgIEdST1VQIEJZICR7TGVhcm5lckFzc2Vzc21lbnRzRW50cnkuQ09MVU1OX05BTUVfUUlEfWA7XG4gICAgfVxuXG4gICAgcHVibGljIHN0YXRpYyBnZXRRdWVzdGlvblJlcG9ydHNRdWVyeSh1aWRzOiBzdHJpbmdbXSwgY29udGVudElkOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gYFNFTEVDVCAqLCBTVU0oJHtMZWFybmVyQXNzZXNzbWVudHNFbnRyeS5DT0xVTU5fTkFNRV9TQ09SRX0pIGFzIG1hcmtzLFxuICAgICAgICAgICAgICAgIENPVU5UICgke0xlYXJuZXJBc3Nlc3NtZW50c0VudHJ5LkNPTFVNTl9OQU1FX1FfSU5ERVh9KSBhcyBvY2N1cmVuY2VfY291bnQsXG4gICAgICAgICAgICAgICAgU1VNICgke0xlYXJuZXJBc3Nlc3NtZW50c0VudHJ5LkNPTFVNTl9OQU1FX01BWF9TQ09SRX0pIGFzICBzdW1fbWF4X3Njb3JlXG4gICAgICAgICAgICAgICAgRlJPTSAke0xlYXJuZXJBc3Nlc3NtZW50c0VudHJ5LlRBQkxFX05BTUV9XG4gICAgICAgICAgICAgICAgV0hFUkUgJHtMZWFybmVyQXNzZXNzbWVudHNFbnRyeS5DT0xVTU5fTkFNRV9VSUR9IElOKCR7QXJyYXlVdGlsLmpvaW5QcmVzZXJ2aW5nUXVvdGVzKHVpZHMpfSlcbiAgICAgICAgICAgICAgICBBTkQgJHtMZWFybmVyQXNzZXNzbWVudHNFbnRyeS5DT0xVTU5fTkFNRV9DT05URU5UX0lEfT0nJHtjb250ZW50SWR9J1xuICAgICAgICAgICAgICAgIEdST1VQIEJZICR7TGVhcm5lckFzc2Vzc21lbnRzRW50cnkuQ09MVU1OX05BTUVfUUlEfWA7XG4gICAgfVxuXG4gICAgcHVibGljIHN0YXRpYyBnZXRGaWx0ZXJGb3JMZWFybmVyQXNzZXNzbWVudERldGFpbHMocWlkOiBzdHJpbmcsIHVpZDogc3RyaW5nLCBjb250ZW50SWQ6IHN0cmluZywgaGllcmFyY2h5RGF0YTogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAgICAgY29uc3QgcWlkRmlsdGVyID0gYCR7TGVhcm5lckFzc2Vzc21lbnRzRW50cnkuQ09MVU1OX05BTUVfUUlEfSA9ICcke3FpZH0nYDtcbiAgICAgICAgY29uc3QgdWlkRmlsdGVyID0gYCR7TGVhcm5lckFzc2Vzc21lbnRzRW50cnkuQ09MVU1OX05BTUVfVUlEfSA9ICcke3VpZH0nYDtcbiAgICAgICAgY29uc3QgY29udGVudElkRmlsdGVyID0gYCR7TGVhcm5lckFzc2Vzc21lbnRzRW50cnkuQ09MVU1OX05BTUVfQ09OVEVOVF9JRH0gPSAnJHtjb250ZW50SWR9J2A7XG4gICAgICAgIGNvbnN0IGhEYXRhRmlsdGVyID0gYCR7TGVhcm5lckFzc2Vzc21lbnRzRW50cnkuQ09MVU1OX05BTUVfSElFUkFSQ0hZX0RBVEF9ID0gJyR7aGllcmFyY2h5RGF0YSA/IGhpZXJhcmNoeURhdGEgOiAnJ30nYDtcbiAgICAgICAgY29uc3QgZmlsdGVyID0gYFdIRVJFICR7dWlkRmlsdGVyfSBBTkQgJHtjb250ZW50SWRGaWx0ZXJ9IEFORCAke2hEYXRhRmlsdGVyfSAke3FpZCA/IGAgQU5EICR7cWlkRmlsdGVyfWAgOiAnJ31gO1xuICAgICAgICByZXR1cm4gZmlsdGVyO1xuICAgIH1cblxuICAgIHB1YmxpYyBzdGF0aWMgZ2V0TGVhcm5lckFzc2Vzc21lbnRzUXVlcnkoZmlsdGVyOiBzdHJpbmcpIHtcbiAgICAgICAgY29uc3QgcXVlcnkgPSBgU0VMRUNUICogZnJvbSAke0xlYXJuZXJBc3Nlc3NtZW50c0VudHJ5LlRBQkxFX05BTUV9ICR7ZmlsdGVyfVxuICAgICAgICAgICAgICAgICAgICAgICBPUkRFUiBCWSAke0xlYXJuZXJBc3Nlc3NtZW50c0VudHJ5LkNPTFVNTl9OQU1FX1FfSU5ERVh9YDtcbiAgICAgICAgcmV0dXJuIHF1ZXJ5O1xuICAgIH1cblxuICAgIHB1YmxpYyBzdGF0aWMgZ2V0VXBkYXRlU2VsZWN0aW9uKCkge1xuICAgICAgICBjb25zdCBxdWVyeSA9IGAke0xlYXJuZXJBc3Nlc3NtZW50c0VudHJ5LkNPTFVNTl9OQU1FX1VJRH0gPSA/IEFORCBgICtcbiAgICAgICAgICAgICAgICAgICAgICAgYCR7TGVhcm5lckFzc2Vzc21lbnRzRW50cnkuQ09MVU1OX05BTUVfQ09OVEVOVF9JRH0gPSA/IEFORCBgICtcbiAgICAgICAgICAgICAgICAgICAgICAgYCR7TGVhcm5lckFzc2Vzc21lbnRzRW50cnkuQ09MVU1OX05BTUVfSElFUkFSQ0hZX0RBVEF9ID0gPyBBTkQgYCArXG4gICAgICAgICAgICAgICAgICAgICAgIGAke0xlYXJuZXJBc3Nlc3NtZW50c0VudHJ5LkNPTFVNTl9OQU1FX1FJRH0gPSA/IGA7XG4gICAgICAgIHJldHVybiBxdWVyeTtcbiAgICB9XG5cbiAgICBwdWJsaWMgc3RhdGljIGdldExlYXJuZXJTdW1tYXJ5UmVhZFNlbGVjdGlvbihoRGF0YTogc3RyaW5nKSB7XG4gICAgICAgIGNvbnN0IHF1ZXJ5ID0gYCR7TGVhcm5lckFzc2Vzc21lbnRzRW50cnkuQ09MVU1OX05BTUVfVUlEfSA9ID8gQU5EIGAgK1xuICAgICAgICAgICAgICAgICAgICAgICBgJHtMZWFybmVyQXNzZXNzbWVudHNFbnRyeS5DT0xVTU5fTkFNRV9DT05URU5UX0lEfSA9ID8gQU5EIGAgK1xuICAgICAgICAgICAgICAgICAgICAgICBgJHtMZWFybmVyQXNzZXNzbWVudHNFbnRyeS5DT0xVTU5fTkFNRV9ISUVSQVJDSFlfREFUQX0gPSA/IGA7XG4gICAgICAgIHJldHVybiBxdWVyeTtcbiAgICB9XG5cbn1cbiJdfQ==